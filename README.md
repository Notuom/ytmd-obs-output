# GPMDP-Output

[Open Broadcaster Software (OBS)](https://obsproject.com/) streaming helper for [YouTube Music Desktop](https://ytmdesktop.app/).

Listens to the Playback interface of YTMD and outputs formatted track information and album art files which can be consumed by OBS.

Very simple script, but it's handy for streaming currently played song from GPMDP and it doesn't require configuration unless you want to customize the output.

## Features

* Automatically polls the YTMD Remote API for changes to the current track
* Output track information to a txt file which can then be used in OBS Studio
  * Customizable track information display
* Output album art to a png file which can then be used in OBS Studio
  * Customizable resolution
* Easy to use! (kinda... ðŸ˜‰)

## Setting up Google Play Music Desktop Player

Before using the script, you should make sure the YTMD remote control API is enabled. [See the official docs for more details](https://github.com/ytmdesktop/ytmdesktop/wiki/Remote-Control-API) (Settings -> Integrations -> Remote Control). Also, make sure your firewall is configured properly by allowing access to Node.js and YTMD if they ask for it (this will vary based on the OS but most likely it will happen).

## Setting up and running the script

If you have prior Node.js experience, this should be no problem. If you don't, I tried to make things as easy as possible :

1. Install [Node.js](https://nodejs.org/) v12 (or whichever LTS is available when you are reading this). Ensure the tools are installed in your PATH (for Windows, this should be an option in the installer).
2. Download this repo. ([Click here to download the latest version as a zip file](https://github.com/Notuom/ytmd-obs-output/archive/master.zip))
3. Extract somewhere you don't mind keeping it (for Windows, somewhere that doesn't require administrator access).
4. Execute the `install.bat` file (Windows) or `install.sh` file (Linux / macOS). You should be able to do that by double-clicking it.
5. Execute the `ytmd_output.bat` file (Windows) or `ytmd_output.sh` file (Linux / macOS). You should be able to do that by double-clicking it.
6. To close the script, use CTRL+C or close the command prompt window.

Steps 1 - 4 only have to be done once. After that, simply execute the relevant `ytmd_output` file and let it run while GPMDP and your streaming application are open.

## Adding the output to OBS Studio

To add the current track info, add a new Text (GDI+) source. Check the "Read from file" box and choose the "Current_Track.txt" file generated by this program.

To add the album art, add a new Image source and select the Current_Album_Art.png file generated by this program.

## Configuration

Open the config.json file in a text editor in order to change settings. Here are all the available settings.

### `ytmdRemoteUrl`

Full URL to the YTMD Remote API.

Default: `http://localhost:9863/query`

### `outputPattern`

The pattern to use when writing the current track information

Valid symbols : `%title%`, `%author%`, `%album%`. Use `\n` to insert a line break.

Default: `%author%\n%title%\n%album%`

**Note:** When the track played is a YouTube video, the album will be empty.

### `albumArtWidth`

The width of the album art to output in pixels.

Default: `500`

**Note:** When the track played is a YouTube video, the cover art won't be square, but it will be resized to fit within the maximum given width and height.

### `albumArtHeight`

The height of the album art to output in pixels.

Default: `500`

**Note:** When the track played is a YouTube video, the cover art won't be square, but it will be resized to fit within the maximum given width and height.

### `trackFilePath`

The file path where to write the text file containing the track information.

You can specify an absolute path in order to write it to a folder different from the script's location.

Default: `Current_Track.txt`

### `albumArtFilePath`

The file path where to write the text file containing the album art.

You can specify an absolute path in order to write it to a folder different from the script's location.

**Note:** An additional file corresponding to this filename followed by ".tmp" will also be written to the folder. This is required in order to resize the image.

Default: `Current_Album_Art.png`

### `pollIntervalMs`

The interval between each request the script will make to the YTMD Remote API in milliseconds.

Default: `1000`

# Special thanks

Special thanks to YTMD for the awesome application and easy to use API!

# Other tools

For Google Play Music Desktop Player: https://github.com/Notuom/gpmdp-output
